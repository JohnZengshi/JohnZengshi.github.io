{"title":"AngularJS中的$http服务","slug":"AngularJS中的$http服务","date":"2017-09-20T07:28:26.008Z","updated":"2017-09-20T14:11:47.974Z","comments":true,"excerpt":"","content":"<blockquote>\n<h2 id=\"AngularJS中的-http服务\"><a href=\"#AngularJS中的-http服务\" class=\"headerlink\" title=\"AngularJS中的$http服务\"></a>AngularJS中的$http服务</h2></blockquote>\n<ul>\n<li><p>$http服务,ng封装的一个ajax请求工具.</p>\n</li>\n<li><p>使用$http服务.</p>\n<pre><code class=\"js\">  $http({\n      //一个对象\n      //通过对象的键值对来指定请求的参数\n\n      url:  //指定要请求的资源的路径.\n      method:  //指定请求的方式 get/post 默认是get\n      params: {}  //当请求方式是get的时候,发送的数据要以键值对的形式存储在这个对象中.\n      data: &quot;&quot; //字符串. 当请求的方式是post的时候,发送的数据要存储在这个属性中.\n      headers: {}  //设置请求头.转换formData格式\n\n      //当请求方式是post的时候,发送的数据的格式ng底层并没有帮我们转换,所以,需要我们手动的加请求头转换formData格式\n  })\n\n  //通过链式编程的方式点1个then方法出来.\n      1.传入两个回调.\n      2.第1个回调:在请求成功的时候执行. 有1个参数(response)\n      3.response 代表服务器返回的数据。\n      4.response.data可以拿到服务器返回的真正的数据.\n      5.第2个回调:在请求失败的时候执行.\n</code></pre>\n</li>\n<li><p>具体实现：</p>\n<pre><code class=\"js\">  &lt;script&gt;\n      var app = angular.module(&quot;hmApp&quot;,[]);\n      app.controller(&quot;hmCtrl&quot;,[&quot;$scope&quot;,&quot;$http&quot;,function($scope,$http){\n          $scope.httpGet = function(){\n              $http({\n                  url:&quot;./php/xxx.php&quot;,\n                  method:&quot;get&quot;,\n              }.then(function(response){\n                  console.log(response.data)\n              },function(){\n                  console.log(&quot;error!&quot;)\n              }))\n\n              //不带数据Get请求\n          }\n\n          $scope.httpPost = function(){\n              $http({\n                  url:&quot;./php/xxx.php&quot;,\n                  method:&quot;post&quot;,\n              }.then(function(response){\n                  console.log(respon.data)\n              },function(){\n                  console.log(&quot;error!&quot;)\n              }))\n\n              //不带数据post请求\n          }\n\n          $scope.httpGetWithData = function(){\n              $http({\n                  url:&quot;./php/xxx.php&quot;,\n                  method:&quot;get&quot;,\n                  params:{\n                      name:&quot;jack&quot;,\n                      pwd:&quot;123456&quot;\n                  }\n              }.then(function(response){\n                  console.log(response.data)\n              },function(){\n                  console.log(&quot;error!&quot;)\n              }))\n\n              //带数据Get请求发送\n          }\n\n          $scope.httpPostWithData = function(){\n              $http({\n                  url:&quot;./php/xxx.php&quot;,\n                  method:&quot;post&quot;,\n                  data:&quot;?name=&#39;jack&#39;&amp;pwd=1234&quot;,\n                  headers:{\n                      &quot;Content-Type&quot;:&quot;application/x-www-form-urlencoded&quot;\n                  }\n              }.then(funciton(response){\n                  console.log(response.data)\n              },function(){\n                  console.log(&quot;error!&quot;)\n              }))\n\n              //带数据post请求发送\n          }\n      }])\n  &lt;/script&gt;\n</code></pre>\n</li>\n<li><p>利用$http进行跨域请求：</p>\n<ul>\n<li>只需要将method设置为jsonp就可以</li>\n<li><p>在发起跨域之前，需要设置一个白名单</p>\n<pre><code class=\"html\">&lt;body ng-app=&quot;hmApp&quot;&gt;\n  &lt;div ng-controller=&quot;demoCtrl&quot;&gt;&lt;/div&gt;\n  &lt;script&gt;\n      var app = angular.module(&quot;hmApp&quot;, []);\n      app.config([&#39;$sceDelegateProvider&#39;, function ($sceDelegateProvider) {\n\n          // 设置跨域白名单\n          $sceDelegateProvider.resourceUrlWhitelist([&quot;https://api.asilu.com/weather/&quot;]);\n      }])\n\n      app.controller(&quot;demoCtrl&quot;, [&quot;$scope&quot;, &quot;$http&quot;, function ($scope, $http) {\n          $http({\n              url: &quot;https://api.asilu.com/weather/&quot;,\n              params: {\n                  city: &quot;深圳&quot;\n              },\n              method: &quot;jsonp&quot;\n          }).then(function (response) {\n              console.log(response.data);\n          });\n      }]);\n  &lt;/script&gt;\n&lt;/body&gt;\n</code></pre>\n</li>\n</ul>\n</li>\n</ul>\n","categories":[],"tags":[]}